<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>OpenLayers Zoomify Example</title>
    <script src="http://oldmapsonline.googlecode.com/svn/trunk/openlayers/OpenLayers.js"></script>
    <script type="text/javascript">

		var width = 18000;
		var height = 10030;
		var url = "http://almor.mzk.cz/moll/AA22/0103/";

        var map, zoomify;

        function init(){
	       /* First we initialize the zoomify pyramid (to get number of tiers) */
	        var zoomify = new OpenLayers.Layer.Zoomify( "Zoomify", url, 
		  		new OpenLayers.Size( width, height ) );
			zoomify.getURL = getURLcustom;
			//zoomify.tileSize = new OpenLayers.Size(512, 512);
			//zoomify.standardTileSize = 512;

	       /* Map with raster coordinates (pixels) from Zoomify image */
	        var options = {
	            controls: [],
	            maxExtent: new OpenLayers.Bounds(0, 0, width, height),
	            maxResolution: Math.pow(2, zoomify.numberOfTiers-1 ),
	            numZoomLevels: zoomify.numberOfTiers,
	            units: 'pixels'
	        };

	        map = new OpenLayers.Map("map", options);
	        map.addLayer(zoomify);

	        map.addControl(new OpenLayers.Control.MousePosition());
	        map.addControl(new OpenLayers.Control.PanZoomBar());
	        map.addControl(new OpenLayers.Control.MouseDefaults());
	        map.addControl(new OpenLayers.Control.KeyboardDefaults());

            map.setBaseLayer(zoomify);
	        map.zoomToMaxExtent();
        };

	    function getURLcustom (bounds) {
	        bounds = this.adjustBounds(bounds);
	        var res = this.map.getResolution();
			var size = this.getImageSize(bounds);
			var x = bounds.left + res*this.standardTileSize/2;
			var y = this.maxExtent.top - bounds.top + res*this.standardTileSize/2;
            var z = this.numZoomLevels - this.map.getZoom() - 1;
			//return "http://chart.apis.google.com/chart?chst=d_text_outline&chs="+size.w+"x"+size.h+"&chf=bg,s,00000055&chld=FFFFFF|16|h|000000|b|"+x+" "+y+"|"+z+"||("+bounds.left+"-"+bounds.right+")|("+bounds.top+"-"+bounds.bottom+")|||||____________________________";
			return "http://memory.loc.gov/cgi-bin/map_image.pl?data=/home/www/data/gmd/gmd3/g3200/g3200/ct000725C.jp2&x="+x+"&y="+y+"&res="+z+"&width="+size.w+"&height="+size.h+"&jpegLevel=80"
	        var url = this.url;
	        if (url instanceof Array) {
	            url = this.selectUrl(path, url);
	        }
	        return url + path;
	    };

    </script>
  </head>
  <body onload="init()">
    <h2 id="title">Library of Congress: Image server</h2>
    <div id="map" style="width:100%; height: 80%; border: 1px solid #aaa;"></div>
  </body>
</html>
